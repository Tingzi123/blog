title: 操作系统的硬件环境
---
1、中央处理器（CPU）
构成:处理器由运算器、控制器、一系列的寄存器以及
高速缓存构成
– 运算器：实现指令中的算术和逻辑运算
– 控制器：负责控制程序运行的流程
– 寄存器：具有最快的访问速度
– 高速缓存：处于CPU和物理内存之间，访问速度快
于内存，低于寄存器

两类寄存器:
（1）用户编程寄存器 
---数据寄存器 
---地址寄存器 
---条件码寄存器 

（2）控制状态寄存器
---程序计数器PC
---指令寄存器IR
---程序状态字PSW
---中断现场保护寄存器

处理器的状态:
– 管态：操作系统管理程序运行的状态，
较高的特权级别，又称为特权态（特态）、
系统态
– 目态：用户程序运行时的状态，较低的
特权级别，又称为普通态（普态）、用户态
– 特权指令：只能由操作系统使用的指令

管态和目态的差别:
– 处理器处于管态时：
• 全部指令（包括特权指令）可以执行
• 可使用所有资源
• 并具有改变处理器状态的能力
– 处理器处于目态时：
• 只有非特权指令能执行

CPU 状 态 的 转 换:
目态--------管态
其转换的唯一途径就是通过中断

管态--------目态
可用设置PSW实现


2、程 序 状 态 字 P S W
特殊寄存器，用以表明处理器当前的工作状态。

通常包括以下状态码：
（1）CPU的工作状态码——指明管态还是目态
（2）条件码——反映指令执行后的结果特征
（3）中断屏蔽码——指出是否允许中断

3、存储系统
![Image text](https://github.com/Tingzi123/blog/blob/master/_posts/picture/ophard1.png?raw=true)

存 储 访 问 局 部 性 原 理:
提高存储系统效能关键点：程序存储访问局部性原理,处理器主要和存储器的局部打交道

4、中 断 机 制
中断机制是操作系统得以正常工作的最重
要的手段：
–它使得OS可以捕获普通程序发出的系统功能调用
–及时处理设备的中断请求
–防止用户程序中破坏性的活动等等

中 断：– CPU对系统发生的某个事件作出的一种反应
– CPU暂停正在执行的程序，保留现场后自动转去执行
相应事件的处理程序，处理完成后返回断点，继续执行
被打断的程序

![Image text](https://github.com/Tingzi123/blog/blob/master/_posts/picture/ophard2.png?raw=true)

– 引入中断的目的
• 解决主机与外设的并行工作问题
• 提高可靠性
• 实现实时控制
– 特点：
• 中断是随机的
• 中断是可恢复的
• 中断是自动处理的

中 断 的 有 关 概 念：
– 中断源：引起中断发生的事件
– 中断寄存器：记录中断
– 中断字：中断寄存器的内容
– 系统堆栈:
在内存开辟的一块区域，用于临时保存现场

中断类型:
– 强迫性中断
• 正在运行的程序所不期望的，由于某种硬件故障
或外部请求引起的
– 自愿性中断
• 用户在程序中有意识安排的中断，是由于用户在
编制程序时因为要求操作系统提供服务，有意使用
“访管”指令或系统调用，使中断发生

强迫性中断
• 输入/输出(I/O)中断：主要来自外部设备通道
• 程序性中断：运行程序中本身的中断
(如溢出,缺页中断,缺段中断,地址越界)
• 时钟中断
• 硬件故障

自愿性中断
• 执行I/O，创建进程，分配内存
• 信号量操作，发送/接收消息
![Image text](https://github.com/Tingzi123/blog/blob/master/_posts/picture/ophard3.png?raw=true)

5、缓 冲 技 术
缓冲区是硬件设备之间进行数据传输时，
用来暂存数据的一个存储区域

–缓冲技术三种用途:
• 处理器与主存储器之间
• 处理器和其它外部设备之间
• 设备与设备之间的通信

–目的：解决部件之间速度不匹配的问题、使得部件并
行工作